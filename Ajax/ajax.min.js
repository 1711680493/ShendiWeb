/**
 * 封装了对 ajax 的操作
 * ajax v1.0 (https://1711680493.github.io)
 * changed in 2020-12-24
 * @author Shendi
 */
var ajax={xhr:function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},req:function(a,b,c,d,e,f){var g=ajax.xhr();g.withCredentials=1==f,null!=c&&(g.onreadystatechange=function(){4==g.readyState&&c(g.responseText,g.status,g)}),g.open(a,b,0==async),g.send(e)},post:function(a,b,c,d,e){var f=ajax.xhr();f.withCredentials=1==e,null!=c&&(f.onreadystatechange=function(){4==f.readyState&&c(f.responseText,f.status,f)}),f.open("POST",a,1==d),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(b)},$:function(a){function l(){if("POST"==c.toUpperCase())if(g){for(q in g)if("CONTENT-TYPE"==q.toUpperCase())return;k=!0}else k=!0}var f,g,h,i,k,m,n,o,p,q,b=ajax.xhr(),c="GET",d="",e=!0;if(null!=a){if(a.type&&(c=a.type),a.url&&(d=a.url),a.async&&(e=a.async),a.uname&&(h=a.uname),a.pwd&&(i=a.pwd),f=a.param,a.heads&&(g=a.heads),b.withCredentials=a.crossDomain?!0:a.crossDomain,a.timeout&&a.async&&(b.timeout=a.timeout),a.respType&&(b.responseType=a.respType),f)if("object"!=typeof f||"[object object]"!=Object.prototype.toString.call(f).toLowerCase()||f.length)"string"==typeof f&&l();else{if(n=Object.keys(f),n.length>0)for(m=n[0]+"="+f[n[0]],o=1;o<n.length;o++)if(p=f[n[o]],"[object Array]"==Object.prototype.toString.call(p).toLowerCase()){q=n[o];for(j in p)m+="&"+q+"="+p[j]}else m+="&"+n[o]+"="+p;f=m,l()}b.onreadystatechange=function(){a.callback&&a.callback(b),4==b.readyState&&(a.finish&&a.finish(b.responseText,b.status,b),a.error&&b.status>=500&&a.error(b.responseText,b.status,b.statusText,b))},a.netErr&&(b.onerror=function(c){a.netErr(b,c)}),a.ontimeout&&(b.ontimeout=function(c){a.ontimeout(b,c)}),b.onload=function(){!a.success||200!=b.status&&304!=b.status||a.success(b.responseText,b.status,b),a.onload&&a.onload(b.responseText,b.status,b)},a.down&&(b.onprogress=function(c){a.down(c,b)}),a.up&&(b.upload.onprogress=function(c){a.up(c.loaded,c.total,c.lengthComputable,c,b)})}try{if(b.open(c,d,e,h,i),k&&b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),g)for(q in g)b.setRequestHeader(q,g[q]);b.send(f)}catch(r){console.log("ajax error: "+r)}}};